<!DOCTYPE html>
<html lang="ru" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="theme-color" content="#ffffff">
  <title>–ê–≤—Ç–æ –¢–û</title>
  <style>
    :root {
      --primary: #1d1d1f;
      --text: #1d1d1f;
      --light-text: #86868b;
      --bg: #ffffff;
      --card-bg: #f5f5f7;
      --accent: #0071e3;
      --border: #e5e5ea;
    }

    [data-theme="dark"] {
      --primary: #f5f5f7;
      --text: #f5f5f7;
      --light-text: #aeaeb2;
      --bg: #000000;
      --card-bg: #1c1c1e;
      --border: #3a3a3c;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro', 'Segoe UI', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.5;
      padding: 1.5rem 1rem;
      max-width: 820px;
      margin: 0 auto;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1.8rem;
      gap: 1rem;
    }

    .logo h1 {
      font-weight: 600;
      font-size: 2rem;
    }

    .controls { display: flex; gap: 0.6rem; }
    .control-btn {
      width: 36px; height: 36px;
      border-radius: 50%;
      border: none;
      background: var(--card-bg);
      color: var(--light-text);
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .subtitle { color: var(--light-text); font-size: 0.95rem; margin-top: 0.4rem; }

    .input-group { display: flex; flex-direction: column; gap: 1rem; margin-bottom: 1.5rem; }
    label { font-size: 0.9rem; color: var(--light-text); font-weight: 500; }
    input {
      padding: 0.8rem 1rem;
      font-size: 1rem;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--card-bg);
      color: var(--text);
    }

    button.primary {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 0.85rem 1.1rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
    }

    #result { margin-top: 1.5rem; display: none; }

    .card {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 1.4rem;
      margin-bottom: 1.2rem;
      border: 1px solid var(--border);
    }

    .card h2, .card h3, .card h4 {
      font-size: 1.25rem;
      margin-bottom: 1rem;
      font-weight: 600;
    }
    .card h4 { font-size: 1.1rem; margin-top: 1rem; }

    .card ul { list-style: none; padding-left: 0; }
    .card li { padding: 0.4rem 0; font-size: 0.95rem; }

    .small { font-size: 0.85rem; color: var(--light-text); }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <h1 id="pageTitle">–ê–≤—Ç–æ –¢–û</h1>
      <p class="subtitle" id="pageSubtitle">–í–≤–µ–¥–∏—Ç–µ VIN –∏–ª–∏ –ø—Ä–æ–±–µ–≥ ‚Äî —É–∑–Ω–∞–π—Ç–µ, —á—Ç–æ –º–µ–Ω—è—Ç—å –∏ –∫–∞–∫–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</p>
    </div>
    <div class="controls">
      <button id="langToggle" class="control-btn">RU</button>
      <button id="themeToggle" class="control-btn">‚òÄÔ∏è</button>
    </div>
  </header>

  <div class="input-group">
    <label for="vin" id="labelVin">VIN / –ú–æ–¥–µ–ª—å (–Ω–∞–ø—Ä.: Prius 2021)</label>
    <input type="text" id="vin" placeholder="JTDKN3DU3M3123456 –∏–ª–∏ Prius 2021">
    <label for="mileage" id="labelMileage">–ü—Ä–æ–±–µ–≥ (–∫–º)</label>
    <input type="number" id="mileage" placeholder="45000" min="0" max="500000">
    <button id="submitBtn" class="primary">–ü–æ–∫–∞–∑–∞—Ç—å –¢–û</button>
  </div>

  <div id="result"></div>

  <script>
    // === –õ–û–ö–ê–õ–ò–ó–ê–¶–ò–Ø (–í–°–Å) ===
    const translations = {
      ru: {
        title: "–ê–≤—Ç–æ –¢–û",
        subtitle: "–í–≤–µ–¥–∏—Ç–µ VIN –∏–ª–∏ –ø—Ä–æ–±–µ–≥ ‚Äî —É–∑–Ω–∞–π—Ç–µ, —á—Ç–æ –º–µ–Ω—è—Ç—å –∏ –∫–∞–∫–∏–µ –∑–∞–ø—á–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å",
        labelVin: "VIN / –ú–æ–¥–µ–ª—å (–Ω–∞–ø—Ä.: Prius 2021)",
        labelMileage: "–ü—Ä–æ–±–µ–≥ (–∫–º)",
        btnSubmit: "–ü–æ–∫–∞–∑–∞—Ç—å –¢–û",
        nextTO: "–°–ª–µ–¥—É—é—â–µ–µ –¢–û",
        dueIn: "—á–µ—Ä–µ–∑",
        km: "–∫–º",
        overdue: "–ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ –Ω–∞",
        oil: "–ú–æ—Ç–æ—Ä–Ω–æ–µ –º–∞—Å–ª–æ",
        filters: "–§–∏–ª—å—Ç—Ä—ã",
        oilFilter: "–ú–∞—Å–ª—è–Ω—ã–π",
        airFilter: "–í–æ–∑–¥—É—à–Ω—ã–π",
        cabinFilter: "–°–∞–ª–æ–Ω–Ω—ã–π",
        fuelFilter: "–¢–æ–ø–ª–∏–≤–Ω—ã–π",
        sparkPlugs: "–°–≤–µ—á–∏ –∑–∞–∂–∏–≥–∞–Ω–∏—è",
        brakes: "–¢–æ—Ä–º–æ–∑–Ω—ã–µ –∫–æ–ª–æ–¥–∫–∏",
        brakeFront: "–ü–µ—Ä–µ–¥–Ω–∏–µ",
        brakeRear: "–ó–∞–¥–Ω–∏–µ",
        timing: "–ì–†–ú",
        chain: "—Ü–µ–ø—å",
        belt: "—Ä–µ–º–µ–Ω—å",
        wheels: "–ö–æ–ª—ë—Å–∞ –∏ –¥–∞–≤–ª–µ–Ω–∏–µ",
        tireSize: "–†–∞–∑–º–µ—Ä —à–∏–Ω",
        pressure: "–î–∞–≤–ª–µ–Ω–∏–µ (–±–∞—Ä)",
        front: "–ø–µ—Ä–µ–¥",
        rear: "–∑–∞–¥",
        recommendations: "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
        inspectAt: "–ü—Ä–æ–≤–µ—Ä–∫–∞ ‚Äî",
        replaceAt: "–ó–∞–º–µ–Ω–∞ ‚Äî",
        every: "–∫–∞–∂–¥—ã–µ",
        at: "–Ω–∞"
      },
      en: {
        title: "Car Maintenance",
        subtitle: "Enter VIN or mileage ‚Äî see what to service and OEM parts to use",
        labelVin: "VIN / Model (e.g. Prius 2021)",
        labelMileage: "Mileage (km)",
        btnSubmit: "Show Maintenance",
        nextTO: "Next Service",
        dueIn: "due in",
        km: "km",
        overdue: "overdue by",
        oil: "Engine Oil",
        filters: "Filters",
        oilFilter: "Oil",
        airFilter: "Air",
        cabinFilter: "Cabin",
        fuelFilter: "Fuel",
        sparkPlugs: "Spark Plugs",
        brakes: "Brake Pads",
        brakeFront: "Front",
        brakeRear: "Rear",
        timing: "Timing System",
        chain: "chain",
        belt: "belt",
        wheels: "Wheels & Tire Pressure",
        tireSize: "Tire size",
        pressure: "Pressure (bar)",
        front: "Front",
        rear: "Rear",
        recommendations: "Notes",
        inspectAt: "Inspect at",
        replaceAt: "Replace at",
        every: "every",
        at: "at"
      }
    };

    // –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    let currentLang = 'ru';
    let currentTheme = 'light';
    let lastQuery = { carKey: null, mileage: 0 };

    // === –§–£–ù–ö–¶–ò–ò –õ–û–ö–ê–õ–ò–ó–ê–¶–ò–ò ===
    function t(key) {
      return translations[currentLang][key] || key;
    }

    function human(km) {
      const k = Math.floor(km / 1000);
      if (km >= 1000) {
        return currentLang === 'ru' ? `${k} —Ç—ã—Å. ${t('km')}` : `${k}k ${t('km')}`;
      }
      return `${km} ${t('km')}`;
    }

    // === –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –Ø–ó–´–ö–ê (–ü–û–õ–ù–ê–Ø –ü–ï–†–ï–†–ò–°–û–í–ö–ê) ===
    function setLanguage(lang) {
      currentLang = lang;
      document.documentElement.lang = lang;
      document.getElementById('langToggle').textContent = lang === 'ru' ? 'RU' : 'EN';
      updateUITexts(); // –æ–±–Ω–æ–≤–ª—è–µ–º –í–ï–°–¨ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
      if (lastQuery.carKey) {
        renderReport(lastQuery.carKey, lastQuery.mileage); // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –æ—Ç—á—ë—Ç
      }
    }

    function setTheme(theme) {
      currentTheme = theme;
      document.documentElement.setAttribute('data-theme', theme);
      document.getElementById('themeToggle').textContent = theme === 'dark' ? 'üåô' : '‚òÄÔ∏è';
      const meta = document.querySelector('meta[name="theme-color"]');
      if (meta) meta.setAttribute('content', theme === 'dark' ? '#000000' : '#ffffff');
    }

    function updateUITexts() {
      document.getElementById('pageTitle').textContent = t('title');
      document.getElementById('pageSubtitle').textContent = t('subtitle');
      document.getElementById('labelVin').textContent = t('labelVin');
      document.getElementById('labelMileage').textContent = t('labelMileage');
      document.getElementById('submitBtn').textContent = t('btnSubmit');
      document.title = t('title');
    }

    // === –î–ê–ù–ù–´–ï ===
    const cars = {
      "prius 2021": {
        name: { ru: "Toyota Prius (2021)", en: "Toyota Prius (2021)" },
        intervals: 10000,
        oil: { every: 10000, type: "0W-20", brands: ["Toyota Genuine 0W-20", "Mobil 1 0W-20"] },
        filters: {
          oil: { interval: 10000, parts: ["Toyota 04152-YZZA1", "Mann W 719/77"] },
          air: { interval: 20000, parts: ["Toyota 17801-YZZ050", "Mann C 25 017"] },
          cabin: { interval: 20000, parts: ["Toyota 87139-YZZ010", "Mann CU 2755"] },
          fuel: { interval: 40000, parts: ["Toyota 23390-0L010"] }
        },
        sparkPlugs: { interval: 100000, parts: ["NGK LFR6AIX-11"] },
        brakePads: {
          front: { interval: 40000, parts: ["Toyota 04465-0K060", "TRW GDB3469"] },
          rear: { interval: 60000, parts: ["Toyota 04466-0K060", "TRW GDB3470"] }
        },
        timing: { type: "chain", check: 100000, replace: 200000 },
        tires: { size: "195/65 R15", pressure: { front: "2.3", rear: "2.2" } },
        notes: {
          ru: ["HV-–±–∞—Ç–∞—Ä–µ—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 40 000 –∫–º"],
          en: ["HV battery: inspect every 40,000 km"]
        }
      }
    };

    function findCar(query) {
      const q = query.toLowerCase();
      if (q.includes('prius') && (q.includes('2021') || q.includes('21'))) return 'prius 2021';
      return null;
    }

    // === –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–¢–û–ë–†–ê–ñ–ï–ù–ò–Ø ===
    function renderReport(carKey, mileage) {
      const car = cars[carKey];
      const nextTO = Math.ceil(mileage / car.intervals) * car.intervals;
      const diff = nextTO - mileage;
      const isOverdue = diff < 0;

      let html = `
        <div class="card" style="border-left: 4px solid var(--accent);">
          <h2>${t('nextTO')}</h2>
          <p style="font-size:1.4rem;font-weight:600;">
            ${human(nextTO)}
            <br><small>
              ${isOverdue ? t('overdue') : t('dueIn')} ${Math.abs(diff)} ${t('km')}
            </small>
          </p>
        </div>
      `;

      // –ú–∞—Å–ª–æ
      html += `
        <div class="card">
          <h3>${t('oil')}</h3>
          <p>${car.oil.type} ‚Äî ${t('every')} ${human(car.oil.every)}</p>
          <p class="small">${car.oil.brands.join(', ')}</p>
        </div>
      `;

      // –§–∏–ª—å—Ç—Ä—ã
      html += `<div class="card"><h3>${t('filters')}</h3><ul>`;
      html += `<li>${t('oilFilter')} ‚Äî ${t('at')} ${human(car.filters.oil.interval)}<br><span class="small">${car.filters.oil.parts.join(', ')}</span></li>`;
      html += `<li>${t('airFilter')} ‚Äî ${t('at')} ${human(car.filters.air.interval)}<br><span class="small">${car.filters.air.parts.join(', ')}</span></li>`;
      html += `<li>${t('cabinFilter')} ‚Äî ${t('at')} ${human(car.filters.cabin.interval)}<br><span class="small">${car.filters.cabin.parts.join(', ')}</span></li>`;
      if (car.filters.fuel) {
        html += `<li>${t('fuelFilter')} ‚Äî ${t('at')} ${human(car.filters.fuel.interval)}<br><span class="small">${car.filters.fuel.parts.join(', ')}</span></li>`;
      }
      html += `</ul></div>`;

      // –¢–æ—Ä–º–æ–∑–∞
      html += `
        <div class="card">
          <h3>${t('brakes')}</h3>
          <h4>${t('brakeFront')}</h4>
          <p>${t('replaceAt')} ${human(car.brakePads.front.interval)}</p>
          <p class="small">${car.brakePads.front.parts.join(', ')}</p>
          
          <h4>${t('brakeRear')}</h4>
          <p>${t('replaceAt')} ${human(car.brakePads.rear.interval)}</p>
          <p class="small">${car.brakePads.rear.parts.join(', ')}</p>
        </div>
      `;

      // –°–≤–µ—á–∏
      if (car.sparkPlugs) {
        html += `
          <div class="card">
            <h3>${t('sparkPlugs')}</h3>
            <p>${t('replaceAt')} ${human(car.sparkPlugs.interval)}</p>
            <p class="small">${car.sparkPlugs.parts.join(', ')}</p>
          </div>
        `;
      }

      // –ì–†–ú
      if (car.timing) {
        const type = car.timing.type === "chain" ? t('chain') : t('belt');
        html += `
          <div class="card">
            <h3>${t('timing')} (${type})</h3>
            <p>${t('inspectAt')} ${human(car.timing.check)}`;
        if (car.timing.replace) {
          html += `<br>${t('replaceAt')} ${human(car.timing.replace)}`;
        }
        html += `</p></div>`;
      }

      // –ö–æ–ª—ë—Å–∞
      if (car.tires) {
        html += `
          <div class="card">
            <h3>${t('wheels')}</h3>
            <ul>
              <li>${t('tireSize')}: <b>${car.tires.size}</b></li>
              <li>${t('pressure')}: ${t('front')} ‚Äî <b>${car.tires.pressure.front}</b>, ${t('rear')} ‚Äî <b>${car.tires.pressure.rear}</b></li>
            </ul>
          </div>
        `;
      }

      // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
      if (car.notes && car.notes[currentLang]) {
        const notes = car.notes[currentLang];
        if (notes.length) {
          html += `<div class="card"><h3>${t('recommendations')}</h3><ul>`;
          notes.forEach(n => html += `<li>${n}</li>`);
          html += `</ul></div>`;
        }
      }

      document.getElementById('result').innerHTML = html;
      document.getElementById('result').style.display = 'block';

      // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —è–∑—ã–∫–∞
      lastQuery = { carKey, mileage };
    }

    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
    setTheme(currentTheme);
    setLanguage(currentLang);

    // === –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò ===
    document.getElementById('langToggle').addEventListener('click', () => {
      setLanguage(currentLang === 'ru' ? 'en' : 'ru');
    });

    document.getElementById('themeToggle').addEventListener('click', () => {
      setTheme(currentTheme === 'light' ? 'dark' : 'light');
    });

    document.getElementById('submitBtn').addEventListener('click', () => {
      const vin = document.getElementById('vin').value.trim();
      const mileage = parseInt(document.getElementById('mileage').value) || 0;

      if (!vin) {
        alert(t('labelVin') + '?');
        return;
      }
      if (mileage < 0 || mileage > 500000) {
        alert(t('labelMileage') + ': 0‚Äì500,000');
        return;
      }

      const carKey = findCar(vin);
      if (carKey && cars[carKey]) {
        renderReport(carKey, mileage);
      } else {
        const msg = currentLang === 'ru' 
          ? '<h2>–ê–≤—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h2><p>Prius 2021, Fit 2020...</p>' 
          : '<h2>Vehicle not found</h2><p>Prius 2021, Fit 2020...</p>';
        document.getElementById('result').innerHTML = `<div class="card">${msg}</div>`;
        document.getElementById('result').style.display = 'block';
        lastQuery = { carKey: null, mileage: 0 };
      }
    });

    document.addEventListener('keypress', e => {
      if (e.key === 'Enter') document.getElementById('submitBtn').click();
    });
  </script>
</body>
</html>